import{r as d,$ as K,a0 as Q}from"./vendor.b52cd847.js";function N(n){var e=d.exports.useRef(n);return e.current=n,e}var X=function(e){var r=N(e);d.exports.useEffect(function(){return function(){r.current()}},[])},M=X;function Y(n,e){if(n===e)return!0;for(var r=0;r<n.length;r++)if(!Object.is(n[r],e[r]))return!1;return!0}function P(n){var e=d.exports.useRef(n);e.current=d.exports.useMemo(function(){return n},[n]);var r=d.exports.useRef();return r.current||(r.current=function(){for(var t=[],a=0;a<arguments.length;a++)t[a]=arguments[a];return e.current.apply(this,t)}),r.current}var Z=globalThis&&globalThis.__read||function(n,e){var r=typeof Symbol=="function"&&n[Symbol.iterator];if(!r)return n;var t=r.call(n),a,i=[],o;try{for(;(e===void 0||e-- >0)&&!(a=t.next()).done;)i.push(a.value)}catch(l){o={error:l}}finally{try{a&&!a.done&&(r=t.return)&&r.call(t)}finally{if(o)throw o.error}}return i},k=function(){var e=Z(d.exports.useState({}),2),r=e[1];return d.exports.useCallback(function(){return r({})},[])},I=k;function z(n,e){var r=d.exports.useRef({deps:e,obj:void 0,initialized:!1}).current;return(r.initialized===!1||!Y(r.deps,e))&&(r.deps=e,r.obj=n(),r.initialized=!0),r.obj}var ee=function(e){return function(r,t){var a=d.exports.useRef(!1);e(function(){return function(){a.current=!1}},[]),e(function(){if(!a.current)a.current=!0;else return r()},t)}},B=ee(d.exports.useEffect),re=function(e){d.exports.useEffect(function(){e==null||e()},[])},ne=re,te=globalThis&&globalThis.__read||function(n,e){var r=typeof Symbol=="function"&&n[Symbol.iterator];if(!r)return n;var t=r.call(n),a,i=[],o;try{for(;(e===void 0||e-- >0)&&!(a=t.next()).done;)i.push(a.value)}catch(l){o={error:l}}finally{try{a&&!a.done&&(r=t.return)&&r.call(t)}finally{if(o)throw o.error}}return i},G=globalThis&&globalThis.__spread||function(){for(var n=[],e=0;e<arguments.length;e++)n=n.concat(te(arguments[e]));return n},q=function(e,r){var t=r.manual,a=r.ready,i=a===void 0?!0:a,o=r.defaultParams,l=o===void 0?[]:o,f=r.refreshDeps,u=f===void 0?[]:f,s=r.refreshDepsAction,c=d.exports.useRef(!1);return c.current=!1,B(function(){!t&&i&&(c.current=!0,e.run.apply(e,G(l)))},[i]),B(function(){c.current||t||(c.current=!0,s?s():e.refresh())},G(u)),{onBefore:function(){if(!i)return{stopNow:!0}}}};q.onInit=function(n){var e=n.ready,r=e===void 0?!0:e,t=n.manual;return{loading:!t&&r}};var ae=q,j=globalThis&&globalThis.__assign||function(){return j=Object.assign||function(n){for(var e,r=1,t=arguments.length;r<t;r++){e=arguments[r];for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(n[a]=e[a])}return n},j.apply(this,arguments)},E=new Map,ie=function(e,r,t){var a=E.get(e);(a==null?void 0:a.timer)&&clearTimeout(a.timer);var i=void 0;r>-1&&(i=setTimeout(function(){E.delete(e)},r)),E.set(e,j(j({},t),{timer:i}))},ue=function(e){return E.get(e)},A=new Map,oe=function(e){return A.get(e)},le=function(e,r){A.set(e,r),r.then(function(t){return A.delete(e),t}).catch(function(){A.delete(e)})},T={},se=function(e,r){T[e]&&T[e].forEach(function(t){return t(r)})},W=function(e,r){return T[e]||(T[e]=[]),T[e].push(r),function(){var a=T[e].indexOf(r);T[e].splice(a,1)}},ce=globalThis&&globalThis.__read||function(n,e){var r=typeof Symbol=="function"&&n[Symbol.iterator];if(!r)return n;var t=r.call(n),a,i=[],o;try{for(;(e===void 0||e-- >0)&&!(a=t.next()).done;)i.push(a.value)}catch(l){o={error:l}}finally{try{a&&!a.done&&(r=t.return)&&r.call(t)}finally{if(o)throw o.error}}return i},fe=globalThis&&globalThis.__spread||function(){for(var n=[],e=0;e<arguments.length;e++)n=n.concat(ce(arguments[e]));return n},ve=function(e,r){var t=r.cacheKey,a=r.cacheTime,i=a===void 0?5*60*1e3:a,o=r.staleTime,l=o===void 0?0:o,f=r.setCache,u=r.getCache,s=d.exports.useRef(),c=d.exports.useRef(),m=function(g,v){f?f(v):ie(g,i,v),se(g,v.data)},b=function(g,v){return v===void 0&&(v=[]),u?u(v):ue(g)};return z(function(){if(!!t){var h=b(t);h&&Object.hasOwnProperty.call(h,"data")&&(e.state.data=h.data,e.state.params=h.params,(l===-1||new Date().getTime()-h.time<=l)&&(e.state.loading=!1)),s.current=W(t,function(g){e.setState({data:g})})}},[]),M(function(){var h;(h=s.current)===null||h===void 0||h.call(s)}),t?{onBefore:function(g){var v=b(t,g);return!v||!Object.hasOwnProperty.call(v,"data")?{}:l===-1||new Date().getTime()-v.time<=l?{loading:!1,data:v==null?void 0:v.data,returnNow:!0}:{data:v==null?void 0:v.data}},onRequest:function(g,v){var p=oe(t);return p&&p!==c.current?{servicePromise:p}:(p=g.apply(void 0,fe(v)),c.current=p,le(t,p),{servicePromise:p})},onSuccess:function(g,v){var p;t&&((p=s.current)===null||p===void 0||p.call(s),m(t,{data:g,params:v,time:new Date().getTime()}),s.current=W(t,function(C){e.setState({data:C})}))},onMutate:function(g){var v;t&&((v=s.current)===null||v===void 0||v.call(s),m(t,{data:g,params:e.state.params,time:new Date().getTime()}),s.current=W(t,function(p){e.setState({data:p})}))}}:{}},de=ve,he=globalThis&&globalThis.__read||function(n,e){var r=typeof Symbol=="function"&&n[Symbol.iterator];if(!r)return n;var t=r.call(n),a,i=[],o;try{for(;(e===void 0||e-- >0)&&!(a=t.next()).done;)i.push(a.value)}catch(l){o={error:l}}finally{try{a&&!a.done&&(r=t.return)&&r.call(t)}finally{if(o)throw o.error}}return i},ge=globalThis&&globalThis.__spread||function(){for(var n=[],e=0;e<arguments.length;e++)n=n.concat(he(arguments[e]));return n},pe=function(e,r){var t=r.debounceWait,a=r.debounceLeading,i=r.debounceTrailing,o=r.debounceMaxWait,l=d.exports.useRef(),f=d.exports.useMemo(function(){var u={};return a!==void 0&&(u.leading=a),i!==void 0&&(u.trailing=i),o!==void 0&&(u.maxWait=o),u},[a,i,o]);return d.exports.useEffect(function(){if(t){var u=e.runAsync.bind(e);return l.current=K(function(s){s()},t,f),e.runAsync=function(){for(var s=[],c=0;c<arguments.length;c++)s[c]=arguments[c];return new Promise(function(m,b){var h;(h=l.current)===null||h===void 0||h.call(l,function(){u.apply(void 0,ge(s)).then(m).catch(b)})})},function(){var s;(s=l.current)===null||s===void 0||s.cancel(),e.runAsync=u}}},[t,f]),t?{onCancel:function(){var s;(s=l.current)===null||s===void 0||s.cancel()}}:{}},me=pe,be=function(e,r){var t=r.loadingDelay,a=d.exports.useRef();if(!t)return{};var i=function(){a.current&&clearTimeout(a.current)};return{onBefore:function(){return i(),a.current=setTimeout(function(){e.setState({loading:!0})},t),{loading:!1}},onFinally:function(){i()},onCancel:function(){i()}}},ye=be;function F(){return!!(typeof window!="undefined"&&window.document&&window.document.createElement)}function L(){return F()?document.visibilityState!=="hidden":!0}var S=[];function _e(n){return S.push(n),function(){var r=S.indexOf(n);S.splice(r,1)}}if(F()){var we=function(){if(!!L())for(var e=0;e<S.length;e++){var r=S[e];r()}};window.addEventListener("visibilitychange",we,!1)}var Te=function(e,r){var t=r.pollingInterval,a=r.pollingWhenHidden,i=a===void 0?!0:a,o=d.exports.useRef(),l=d.exports.useRef(),f=function(){var s;o.current&&clearTimeout(o.current),(s=l.current)===null||s===void 0||s.call(l)};return B(function(){t||f()},[t]),t?{onBefore:function(){f()},onFinally:function(){if(!i&&!L()){l.current=_e(function(){e.refresh()});return}o.current=setTimeout(function(){e.refresh()},t)},onCancel:function(){f()}}:{}},Pe=Te,xe=globalThis&&globalThis.__read||function(n,e){var r=typeof Symbol=="function"&&n[Symbol.iterator];if(!r)return n;var t=r.call(n),a,i=[],o;try{for(;(e===void 0||e-- >0)&&!(a=t.next()).done;)i.push(a.value)}catch(l){o={error:l}}finally{try{a&&!a.done&&(r=t.return)&&r.call(t)}finally{if(o)throw o.error}}return i},Re=globalThis&&globalThis.__spread||function(){for(var n=[],e=0;e<arguments.length;e++)n=n.concat(xe(arguments[e]));return n};function Se(n,e){var r=!1;return function(){for(var t=[],a=0;a<arguments.length;a++)t[a]=arguments[a];r||(r=!0,n.apply(void 0,Re(t)),setTimeout(function(){r=!1},e))}}function Oe(){return F()&&typeof navigator.onLine!="undefined"?navigator.onLine:!0}var O=[];function Ce(n){return O.push(n),function(){var r=O.indexOf(n);O.splice(r,1)}}if(F()){var V=function(){if(!(!L()||!Oe()))for(var e=0;e<O.length;e++){var r=O[e];r()}};window.addEventListener("visibilitychange",V,!1),window.addEventListener("focus",V,!1)}var $e=function(e,r){var t=r.refreshOnWindowFocus,a=r.focusTimespan,i=a===void 0?5e3:a,o=d.exports.useRef(),l=function(){var u;(u=o.current)===null||u===void 0||u.call(o)};return d.exports.useEffect(function(){if(t){var f=Se(e.refresh.bind(e),i);o.current=Ce(function(){f()})}return function(){l()}},[t,i]),M(function(){l()}),{}},je=$e,Ee=function(e,r){var t=r.retryInterval,a=r.retryCount,i=d.exports.useRef(),o=d.exports.useRef(0),l=d.exports.useRef(!1);return a?{onBefore:function(){l.current||(o.current=0),l.current=!1,i.current&&clearTimeout(i.current)},onSuccess:function(){o.current=0},onError:function(){if(o.current+=1,a===-1||o.current<=a){var u=t!=null?t:Math.min(1e3*Math.pow(2,o.current),3e4);i.current=setTimeout(function(){l.current=!0,e.refresh()},u)}else o.current=0},onCancel:function(){o.current=0,i.current&&clearTimeout(i.current)}}:{}},Ae=Ee,Fe=globalThis&&globalThis.__read||function(n,e){var r=typeof Symbol=="function"&&n[Symbol.iterator];if(!r)return n;var t=r.call(n),a,i=[],o;try{for(;(e===void 0||e-- >0)&&!(a=t.next()).done;)i.push(a.value)}catch(l){o={error:l}}finally{try{a&&!a.done&&(r=t.return)&&r.call(t)}finally{if(o)throw o.error}}return i},De=globalThis&&globalThis.__spread||function(){for(var n=[],e=0;e<arguments.length;e++)n=n.concat(Fe(arguments[e]));return n},Me=function(e,r){var t=r.throttleWait,a=r.throttleLeading,i=r.throttleTrailing,o=d.exports.useRef(),l={};return a!==void 0&&(l.leading=a),i!==void 0&&(l.trailing=i),d.exports.useEffect(function(){if(t){var f=e.runAsync.bind(e);return o.current=Q(function(u){u()},t,l),e.runAsync=function(){for(var u=[],s=0;s<arguments.length;s++)u[s]=arguments[s];return new Promise(function(c,m){var b;(b=o.current)===null||b===void 0||b.call(o,function(){f.apply(void 0,De(u)).then(c).catch(m)})})},function(){var u;e.runAsync=f,(u=o.current)===null||u===void 0||u.cancel()}}},[t,a,i]),t?{onCancel:function(){var u;(u=o.current)===null||u===void 0||u.cancel()}}:{}},Be=Me,y=globalThis&&globalThis.__assign||function(){return y=Object.assign||function(n){for(var e,r=1,t=arguments.length;r<t;r++){e=arguments[r];for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(n[a]=e[a])}return n},y.apply(this,arguments)},We=globalThis&&globalThis.__awaiter||function(n,e,r,t){function a(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function l(s){try{u(t.next(s))}catch(c){o(c)}}function f(s){try{u(t.throw(s))}catch(c){o(c)}}function u(s){s.done?i(s.value):a(s.value).then(l,f)}u((t=t.apply(n,e||[])).next())})},Le=globalThis&&globalThis.__generator||function(n,e){var r={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},t,a,i,o;return o={next:l(0),throw:l(1),return:l(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function l(u){return function(s){return f([u,s])}}function f(u){if(t)throw new TypeError("Generator is already executing.");for(;r;)try{if(t=1,a&&(i=u[0]&2?a.return:u[0]?a.throw||((i=a.return)&&i.call(a),0):a.next)&&!(i=i.call(a,u[1])).done)return i;switch(a=0,i&&(u=[u[0]&2,i.value]),u[0]){case 0:case 1:i=u;break;case 4:return r.label++,{value:u[1],done:!1};case 5:r.label++,a=u[1],u=[0];continue;case 7:u=r.ops.pop(),r.trys.pop();continue;default:if(i=r.trys,!(i=i.length>0&&i[i.length-1])&&(u[0]===6||u[0]===2)){r=0;continue}if(u[0]===3&&(!i||u[1]>i[0]&&u[1]<i[3])){r.label=u[1];break}if(u[0]===6&&r.label<i[1]){r.label=i[1],i=u;break}if(i&&r.label<i[2]){r.label=i[2],r.ops.push(u);break}i[2]&&r.ops.pop(),r.trys.pop();continue}u=e.call(n,r)}catch(s){u=[6,s],a=0}finally{t=i=0}if(u[0]&5)throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}},He=globalThis&&globalThis.__rest||function(n,e){var r={};for(var t in n)Object.prototype.hasOwnProperty.call(n,t)&&e.indexOf(t)<0&&(r[t]=n[t]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,t=Object.getOwnPropertySymbols(n);a<t.length;a++)e.indexOf(t[a])<0&&Object.prototype.propertyIsEnumerable.call(n,t[a])&&(r[t[a]]=n[t[a]]);return r},Ue=globalThis&&globalThis.__read||function(n,e){var r=typeof Symbol=="function"&&n[Symbol.iterator];if(!r)return n;var t=r.call(n),a,i=[],o;try{for(;(e===void 0||e-- >0)&&!(a=t.next()).done;)i.push(a.value)}catch(l){o={error:l}}finally{try{a&&!a.done&&(r=t.return)&&r.call(t)}finally{if(o)throw o.error}}return i},x=globalThis&&globalThis.__spread||function(){for(var n=[],e=0;e<arguments.length;e++)n=n.concat(Ue(arguments[e]));return n},Ne=function(){function n(e,r,t,a){a===void 0&&(a={}),this.serviceRef=e,this.options=r,this.subscribe=t,this.initState=a,this.count=0,this.state={loading:!1,params:void 0,data:void 0,error:void 0},this.state=y(y(y({},this.state),{loading:!r.manual}),a)}return n.prototype.setState=function(e){e===void 0&&(e={}),this.state=y(y({},this.state),e),this.subscribe()},n.prototype.runPluginHandler=function(e){for(var r=[],t=1;t<arguments.length;t++)r[t-1]=arguments[t];var a=this.pluginImpls.map(function(i){var o;return(o=i[e])===null||o===void 0?void 0:o.call.apply(o,x([i],r))}).filter(Boolean);return Object.assign.apply(Object,x([{}],a))},n.prototype.runAsync=function(){for(var e,r,t,a,i,o,l,f,u,s,c=[],m=0;m<arguments.length;m++)c[m]=arguments[m];return We(this,void 0,void 0,function(){var b,h,g,v,p,C,D,$,_,w,U;return Le(this,function(R){switch(R.label){case 0:if(this.count+=1,b=this.count,h=this.runPluginHandler("onBefore",c),g=h.stopNow,v=g===void 0?!1:g,p=h.returnNow,C=p===void 0?!1:p,D=He(h,["stopNow","returnNow"]),v)return[2,new Promise(function(){})];if(this.setState(y({loading:!0,params:c},D)),C)return[2,Promise.resolve(D.data)];(r=(e=this.options).onBefore)===null||r===void 0||r.call(e,c),R.label=1;case 1:return R.trys.push([1,3,,4]),$=this.runPluginHandler("onRequest",this.serviceRef.current,c).servicePromise,$||($=(U=this.serviceRef).current.apply(U,x(c))),[4,$];case 2:return _=R.sent(),b!==this.count?[2,new Promise(function(){})]:(this.setState({data:_,error:void 0,loading:!1}),(a=(t=this.options).onSuccess)===null||a===void 0||a.call(t,_,c),this.runPluginHandler("onSuccess",_,c),(o=(i=this.options).onFinally)===null||o===void 0||o.call(i,c,_,void 0),b===this.count&&this.runPluginHandler("onFinally",c,_,void 0),[2,_]);case 3:if(w=R.sent(),b!==this.count)return[2,new Promise(function(){})];throw this.setState({error:w,loading:!1}),(f=(l=this.options).onError)===null||f===void 0||f.call(l,w,c),this.runPluginHandler("onError",w,c),(s=(u=this.options).onFinally)===null||s===void 0||s.call(u,c,void 0,w),b===this.count&&this.runPluginHandler("onFinally",c,void 0,w),w;case 4:return[2]}})})},n.prototype.run=function(){for(var e=this,r=[],t=0;t<arguments.length;t++)r[t]=arguments[t];this.runAsync.apply(this,x(r)).catch(function(a){e.options.onError||console.error(a)})},n.prototype.cancel=function(){this.count+=1,this.setState({loading:!1}),this.runPluginHandler("onCancel")},n.prototype.refresh=function(){this.run.apply(this,x(this.state.params||[]))},n.prototype.refreshAsync=function(){return this.runAsync.apply(this,x(this.state.params||[]))},n.prototype.mutate=function(e){var r;typeof e=="function"?r=e(this.state.data):r=e,this.runPluginHandler("onMutate",r),this.setState({data:r})},n}(),ze=Ne,H=globalThis&&globalThis.__assign||function(){return H=Object.assign||function(n){for(var e,r=1,t=arguments.length;r<t;r++){e=arguments[r];for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(n[a]=e[a])}return n},H.apply(this,arguments)},Ge=globalThis&&globalThis.__rest||function(n,e){var r={};for(var t in n)Object.prototype.hasOwnProperty.call(n,t)&&e.indexOf(t)<0&&(r[t]=n[t]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,t=Object.getOwnPropertySymbols(n);a<t.length;a++)e.indexOf(t[a])<0&&Object.prototype.propertyIsEnumerable.call(n,t[a])&&(r[t[a]]=n[t[a]]);return r},qe=globalThis&&globalThis.__read||function(n,e){var r=typeof Symbol=="function"&&n[Symbol.iterator];if(!r)return n;var t=r.call(n),a,i=[],o;try{for(;(e===void 0||e-- >0)&&!(a=t.next()).done;)i.push(a.value)}catch(l){o={error:l}}finally{try{a&&!a.done&&(r=t.return)&&r.call(t)}finally{if(o)throw o.error}}return i},J=globalThis&&globalThis.__spread||function(){for(var n=[],e=0;e<arguments.length;e++)n=n.concat(qe(arguments[e]));return n};function Ve(n,e,r){e===void 0&&(e={}),r===void 0&&(r=[]);var t=e.manual,a=t===void 0?!1:t,i=Ge(e,["manual"]),o=H({manual:a},i),l=N(n),f=I(),u=z(function(){var s=r.map(function(c){var m;return(m=c==null?void 0:c.onInit)===null||m===void 0?void 0:m.call(c,o)}).filter(Boolean);return new ze(l,o,f,Object.assign.apply(Object,J([{}],s)))},[]);return u.options=o,u.pluginImpls=r.map(function(s){return s(u,o)}),ne(function(){if(!a){var s=u.state.params||e.defaultParams||[];u.run.apply(u,J(s))}}),M(function(){u.cancel()}),{loading:u.state.loading,data:u.state.data,error:u.state.error,params:u.state.params||[],cancel:P(u.cancel.bind(u)),refresh:P(u.refresh.bind(u)),refreshAsync:P(u.refreshAsync.bind(u)),run:P(u.run.bind(u)),runAsync:P(u.runAsync.bind(u)),mutate:P(u.mutate.bind(u))}}var Je=globalThis&&globalThis.__read||function(n,e){var r=typeof Symbol=="function"&&n[Symbol.iterator];if(!r)return n;var t=r.call(n),a,i=[],o;try{for(;(e===void 0||e-- >0)&&!(a=t.next()).done;)i.push(a.value)}catch(l){o={error:l}}finally{try{a&&!a.done&&(r=t.return)&&r.call(t)}finally{if(o)throw o.error}}return i},Ke=globalThis&&globalThis.__spread||function(){for(var n=[],e=0;e<arguments.length;e++)n=n.concat(Je(arguments[e]));return n};function Xe(n,e,r){return Ve(n,e,Ke(r||[],[me,ye,Pe,je,Be,ae,de,Ae]))}export{Xe as u};
